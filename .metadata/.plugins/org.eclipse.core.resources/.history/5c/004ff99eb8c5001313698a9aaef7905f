package com.returnjump.spoilfoil;

import java.util.Calendar;
import java.util.Date;
import java.util.GregorianCalendar;
import java.util.concurrent.TimeUnit;

/**
 * This class represents one food item
 * @author Kelsey Hrubes
 *
 */

public class FoodItem implements FoodItemInterface { 

	private String foodName;
	private Calendar expiryDate;
	private int numberOfItems;

	public FoodItem(String foodName, Calendar expiryDate, int numberOfItems) {
		this.foodName = foodName;
		this.expiryDate = expiryDate;
        this.numberOfItems = numberOfItems;
	}

	public int getDaysGood() {
	    long today = GregorianCalendar.getInstance().getTimeInMillis() / 86400000L * 86400000L;
	    long expiryDay = this.expiryDate.getTimeInMillis()
		int diffInDays = (int) ((expiryDay - today) / 86400000L);
		return days + 1;
	}

	public void setExpiryDate(Calendar newExpiryDate) {
		this.expiryDate = newExpiryDate;
	}

	public String getFoodItemName() {
		return this.foodName;
	}

	public Date getExpiryDate() {
		return this.expiryDate;
	}
	
	//called by the adapter
	public String toString(){
		String s;
		
		if(this.numberOfItems==0 ){
		    s = this.getFoodItemName()+"    "+ this.getDaysGood();
		}else{
		    s = this.getFoodItemName()+" ("+this.numberOfItems+")     "+ this.getDaysGood();
		}
	  
		return s;
	}


	@Override
	public int getNumberOfThisFoodItem() {
		return numberOfItems;
	}

	@Override
	public void setNumberOfThisFoodItem(int numberOfThisItem) {
		this.numberOfItems = numberOfThisItem;
	}
	
	public int getExpirationNumber() {
	    int daysGood = getDaysGood();
	    
	    if (daysGood >= 28) {
	        daysGood = daysGood / 28;
	    } else if (daysGood >= 7) {
	        daysGood = daysGood / 7;
	    }
	    
	    return daysGood;
	}
	
	public String getExpirationUnit() {
	    int daysGood = getDaysGood();
	    String unit;
	    
	    if (daysGood >= 28) {
            daysGood = daysGood / 28;
            
            if (daysGood == 1) {
                unit = "month";
            } else {
                unit = "months";
            }
        } else if (daysGood >= 7) {
            daysGood = daysGood / 7;
            
            if (daysGood == 1) {
                unit = "week";
            } else {
                unit = "weeks";
            }
        } else {
            if (daysGood == 1) {
                unit = "day";
            } else {
                unit = "days";
            }
        }
	    
	    return unit;
	}

}
